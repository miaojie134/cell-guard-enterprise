import{c as je,y as f,j as e,H as se,L as ye,ad as ve,u as be,b as Ce,M as we,B as I,V as v,C as S,g as E,a5 as K,d as M,e as T,f as k,r as V,t as R,ae as q,af as F,ag as Ie,ah as Se,U as J,s as z,ac as b}from"./index-CtZ2PKlW.js";import{v as B}from"./verificationService-B0VH615L.js";import{C as Q}from"./checkbox-DIcI0gxp.js";import{A as Ee}from"./arrow-left-DxTLDNlc.js";import{C as $e}from"./chart-column-CeDIYINX.js";import{a as Y,C as G}from"./clock-CTH7TFfH.js";/**
 * @license lucide-react v0.462.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const Ae=je("RefreshCw",[["path",{d:"M3 12a9 9 0 0 1 9-9 9.75 9.75 0 0 1 6.74 2.74L21 8",key:"v9h5vc"}],["path",{d:"M21 3v5h-5",key:"1q7to0"}],["path",{d:"M21 12a9 9 0 0 1-9 9 9.75 9.75 0 0 1-6.74-2.74L3 16",key:"3uifl3"}],["path",{d:"M8 16H3v5",key:"1cv678"}]]);function Pe(l,i=[]){let p=[];function h(g,m){const o=f.createContext(m),u=p.length;p=[...p,m];function C($){const{scope:N,children:w,...A}=$,_=(N==null?void 0:N[l][u])||o,L=f.useMemo(()=>A,Object.values(A));return e.jsx(_.Provider,{value:L,children:w})}function r($,N){const w=(N==null?void 0:N[l][u])||o,A=f.useContext(w);if(A)return A;if(m!==void 0)return m;throw new Error(`\`${$}\` must be used within \`${g}\``)}return C.displayName=g+"Provider",[C,r]}const d=()=>{const g=p.map(m=>f.createContext(m));return function(o){const u=(o==null?void 0:o[l])||g;return f.useMemo(()=>({[`__scope${l}`]:{...o,[l]:u}}),[o,u])}};return d.scopeName=l,[h,Me(d,...i)]}function Me(...l){const i=l[0];if(l.length===1)return i;const p=()=>{const h=l.map(d=>({useScope:d(),scopeName:d.scopeName}));return function(g){const m=h.reduce((o,{useScope:u,scopeName:C})=>{const $=u(g)[`__scope${C}`];return{...o,...$}},{});return f.useMemo(()=>({[`__scope${i.scopeName}`]:m}),[m])}};return p.scopeName=i.scopeName,p}var U="Progress",H=100,[ke,Ge]=Pe(U),[De,Re]=ke(U),te=f.forwardRef((l,i)=>{const{__scopeProgress:p,value:h=null,max:d,getValueLabel:g=Oe,...m}=l;(d||d===0)&&!Z(d)&&console.error(_e(`${d}`,"Progress"));const o=Z(d)?d:H;h!==null&&!ee(h,o)&&console.error(Le(`${h}`,"Progress"));const u=ee(h,o)?h:null,C=O(u)?g(u,o):void 0;return e.jsx(De,{scope:p,value:u,max:o,children:e.jsx(se.div,{"aria-valuemax":o,"aria-valuemin":0,"aria-valuenow":O(u)?u:void 0,"aria-valuetext":C,role:"progressbar","data-state":le(u,o),"data-value":u??void 0,"data-max":o,...m,ref:i})})});te.displayName=U;var ae="ProgressIndicator",re=f.forwardRef((l,i)=>{const{__scopeProgress:p,...h}=l,d=Re(ae,p);return e.jsx(se.div,{"data-state":le(d.value,d.max),"data-value":d.value??void 0,"data-max":d.max,...h,ref:i})});re.displayName=ae;function Oe(l,i){return`${Math.round(l/i*100)}%`}function le(l,i){return l==null?"indeterminate":l===i?"complete":"loading"}function O(l){return typeof l=="number"}function Z(l){return O(l)&&!isNaN(l)&&l>0}function ee(l,i){return O(l)&&!isNaN(l)&&l<=i&&l>=0}function _e(l,i){return`Invalid prop \`max\` of value \`${l}\` supplied to \`${i}\`. Only numbers greater than 0 are valid max values. Defaulting to \`${H}\`.`}function Le(l,i){return`Invalid prop \`value\` of value \`${l}\` supplied to \`${i}\`. The \`value\` prop must be:
  - a positive number
  - less than the value passed to \`max\` (or ${H} if no \`max\` prop is set)
  - \`null\` or \`undefined\` if the progress is indeterminate.

Defaulting to \`null\`.`}var ne=te,Te=re;const ce=f.forwardRef(({className:l,value:i,...p},h)=>e.jsx(ne,{ref:h,className:ye("relative h-4 w-full overflow-hidden rounded-full bg-secondary",l),...p,children:e.jsx(Te,{className:"h-full w-full flex-1 bg-primary transition-all",style:{transform:`translateX(-${100-(i||0)}%)`}})}));ce.displayName=ne.displayName;const Ue=()=>{const{batchId:l}=ve(),i=be(),[p,h]=f.useState({}),[d,g]=f.useState({}),[m,o]=f.useState([]),[u,C]=f.useState(!1),{data:r,isLoading:$,error:N,refetch:w}=Ce({queryKey:["verification","batch",l],queryFn:()=>{if(!l)throw new Error("缺少批处理ID");return B.getBatchStatus(l)},enabled:!!l,refetchInterval:s=>{const n=s.state.data;return(n==null?void 0:n.status)===v.PENDING||(n==null?void 0:n.status)===v.IN_PROGRESS?1e4:!1},retry:!1});f.useEffect(()=>{if((r==null?void 0:r.requestedScopeType)==="employee_ids"&&r.requestedScopeValues){console.log("原始员工范围值:",r.requestedScopeValues),console.log("员工范围值类型:",typeof r.requestedScopeValues);let s=[];try{s=JSON.parse(r.requestedScopeValues),console.log("JSON解析后的员工工号数组:",s)}catch(t){console.log("JSON解析失败，使用逗号分隔解析:",t),s=r.requestedScopeValues.split(",").map(a=>a.trim())}console.log("最终员工工号数组:",s),console.log("第一个员工工号:",s[0],"类型:",typeof s[0]),(async()=>{const t={};for(const a of s)try{console.log(`搜索员工工号: "${a}" (类型: ${typeof a})`);const c=await Ie.getEmployees({search:a,limit:10,page:1});console.log(`员工 ${a} 搜索响应:`,c);const x=c.items.find(y=>y.employeeId===a);x?(t[a]=x.fullName,console.log(`找到员工: ${a} -> ${x.fullName}`)):(console.log(`未找到员工: ${a}，搜索结果:`,c.items),t[a]=a)}catch(c){console.error(`搜索员工 ${a} 失败:`,c),t[a]=a}console.log("员工姓名映射结果:",t),h(t)})()}else if((r==null?void 0:r.requestedScopeType)==="department_ids"&&r.requestedScopeValues){console.log("原始部门范围值:",r.requestedScopeValues);let s=[];try{s=JSON.parse(r.requestedScopeValues),console.log("JSON解析后的部门ID数组:",s)}catch(t){console.log("部门ID JSON解析失败，使用逗号分隔解析:",t),s=r.requestedScopeValues.split(",").map(a=>a.trim())}(async()=>{const t={};for(const a of s)try{console.log(`获取部门ID: ${a} 的信息`);const c=await Se.getDepartmentById(parseInt(a));t[a]=c.name,console.log(`找到部门: ${a} -> ${c.name}`)}catch(c){console.error(`获取部门 ${a} 信息失败:`,c),t[a]=`部门${a}`}console.log("部门名称映射结果:",t),g(t)})()}},[r]);const A=()=>{w()},_=()=>{if(!r)return 0;const{totalEmployeesToProcess:s,tokensGeneratedCount:n}=r;return s===0?0:Math.round(n/s*100)},L=()=>{if(!r)return{color:"gray",icon:G,text:"未知"};switch(r.status){case v.PENDING:return{color:"yellow",icon:G,text:"等待处理"};case v.IN_PROGRESS:return{color:"blue",icon:K,text:"处理中"};case v.COMPLETED:return{color:"green",icon:Y,text:"已完成"};case v.COMPLETED_WITH_ERRORS:return{color:"orange",icon:k,text:"完成（有错误）"};case v.FAILED:return{color:"red",icon:k,text:"失败"};default:return{color:"gray",icon:G,text:"未知状态"}}},ie=()=>{if(!r)return{text:"未知",icon:R,detail:""};const{requestedScopeType:s,requestedScopeValues:n}=r;switch(s){case"all_users":return{text:"全员盘点",icon:R,detail:"所有在职员工"};case"department_ids":if(n){let t=[];try{t=JSON.parse(n)}catch{t=n.split(",").map(c=>c.trim())}if(Object.keys(d).length>0){const a=t.map(c=>d[c]||`部门${c}`);return{text:"按部门盘点",icon:z,detail:`部门名称: ${a.join(", ")} (${a.length}个部门)`}}else return{text:"按部门盘点",icon:z,detail:`部门ID: ${t.join(", ")} (${t.length}个部门)`}}return{text:"按部门盘点",icon:z,detail:"部门信息缺失"};case"employee_ids":if(n){let t=[];try{t=JSON.parse(n)}catch{t=n.split(",").map(c=>c.trim())}if(Object.keys(p).length>0){const a=t.map(c=>p[c]||c);return{text:"按员工盘点",icon:J,detail:`员工: ${a.join(", ")} (${a.length}位员工)`}}else return{text:"按员工盘点",icon:J,detail:`员工: ${t.join(", ")} (${t.length}位员工)`}}return{text:"按员工盘点",icon:J,detail:"员工信息缺失"};default:return{text:s,icon:R,detail:n||""}}},oe=()=>!r||r.emailsAttemptedCount===0?0:Math.round(r.emailsSucceededCount/r.emailsAttemptedCount*100),de=s=>{try{const n=JSON.parse(s);return Array.isArray(n)?n.map(t=>({employeeId:t.employeeId||"未知",employeeName:t.employeeName||p[t.employeeId]||"未知员工",emailAddress:t.emailAddress||"未知邮箱",reason:P(t.reason||"")})):[{employeeId:n.employeeId||"未知",employeeName:n.employeeName||"未知员工",emailAddress:n.emailAddress||"未知邮箱",reason:P(n.reason||s)}]}catch{try{const t=s.trim().split(`
`).filter(c=>c.trim()),a=[];for(const c of t)try{const x=JSON.parse(c.trim());a.push({employeeId:x.employeeId||"未知",employeeName:x.employeeName||p[x.employeeId]||"未知员工",emailAddress:x.emailAddress||"未知邮箱",reason:P(x.reason||"")})}catch(x){console.error("解析单行错误信息失败:",c,x);const y=c.match(/(\w+@[\w.-]+\.\w+)/),X=c.match(/employeeName":"([^"]+)"/);a.push({employeeId:"未知",employeeName:X?X[1]:"未知员工",emailAddress:y?y[1]:"未知邮箱",reason:P(c)})}return a.length>0?a:[{employeeId:"未知",employeeName:"未知员工",emailAddress:"未知邮箱",reason:P(s)}]}catch(t){console.error("解析多行错误信息失败:",t);const a=s.match(/(\w+@[\w.-]+\.\w+)/),c=s.match(/employeeName":"([^"]+)"/);return[{employeeId:"未知",employeeName:c?c[1]:"未知员工",emailAddress:a?a[1]:"未知邮箱",reason:P(s)}]}}},me=s=>{if(!(s!=null&&s.trim()))return[];try{const n=s.trim().split(`
`),t=[];for(const a of n)if(a.trim())try{const c=JSON.parse(a.trim());t.push({employeeId:c.employeeId||"未知",employeeName:c.employeeName||"未知员工",departmentName:c.departmentName||"未知部门",emailAddress:c.emailAddress||"N/A",reason:xe(c.reason||"未知原因")})}catch(c){console.error("解析跳过员工信息行失败:",c,"行内容:",a);const x=a.match(/employeeId[":]+([^",]+)/),y=a.match(/employeeName[":]+([^",]+)/);t.push({employeeId:x?x[1]:"未知",employeeName:y?y[1]:"未知员工",departmentName:"未知部门",emailAddress:"N/A",reason:"信息解析失败"})}return t}catch(n){return console.error("解析跳过员工摘要失败:",n),[]}},xe=s=>s.includes("没有分配任何手机号码")||s.includes("无手机号码")?"未分配手机号码":s.includes("查询手机号码失败")||s.includes("database")?"查询失败":s.includes("员工已离职")||s.includes("非在职")?"员工已离职":s.includes("邮箱地址无效")||s.includes("email")?"邮箱地址无效":s.length>20?"其他原因":s,P=s=>s.includes("SMTP rcpt to failed: 554")||s.includes("User unknown")?"邮箱地址无效":s.includes("Connection timeout")||s.includes("timeout")?"邮件服务器超时":s.includes("Authentication failed")?"邮件服务器认证失败":s.includes("Mailbox full")||s.includes("over quota")?"员工邮箱已满":s.includes("Blocked")||s.includes("spam")?"被识别为垃圾邮件":"邮件发送失败",ue=async()=>{if(m.length===0){b({title:"请选择员工",description:"请先选择需要补发邮件的员工",variant:"destructive"});return}if(!l){b({title:"错误",description:"缺少批处理任务ID",variant:"destructive"});return}try{console.log("开始补发邮件，选中员工:",m);const s=await B.resendFailedEmails(l,m);console.log("补发邮件结果:",s);const n=`补发完成：总计 ${s.totalAttempted} 人，成功 ${s.successCount} 人，失败 ${s.failedCount} 人`;if(s.failedCount===0)b({title:"补发成功",description:n});else{const t=s.failedEmails.map(a=>a.employeeName).join(", ");b({title:s.successCount>0?"部分补发成功":"补发失败",description:`${n}${s.failedCount>0?`
失败员工：${t}`:""}`,variant:s.successCount>0?"default":"destructive"})}o([]),w()}catch(s){console.error("补发邮件失败:",s),b({title:"补发失败",description:s instanceof Error?s.message:"补发邮件失败，请稍后重试",variant:"destructive"})}},pe=s=>{m.length===s.length?o([]):o(s.map(n=>n.employeeId))},he=async()=>{if(!l){b({title:"错误",description:"缺少批处理任务ID",variant:"destructive"});return}try{console.log("开始补发全部失败邮件");const s=await B.resendFailedEmails(l);console.log("补发全部失败邮件结果:",s);const n=`补发完成：总计 ${s.totalAttempted} 人，成功 ${s.successCount} 人，失败 ${s.failedCount} 人`;if(s.failedCount===0)b({title:"补发成功",description:n});else{const t=s.failedEmails.map(a=>a.employeeName).join(", ");b({title:s.successCount>0?"部分补发成功":"补发失败",description:`${n}${s.failedCount>0?`
失败员工：${t}`:""}`,variant:s.successCount>0?"default":"destructive"})}o([]),w()}catch(s){console.error("补发全部失败邮件失败:",s),b({title:"补发失败",description:s instanceof Error?s.message:"补发邮件失败，请稍后重试",variant:"destructive"})}},j=L(),D=ie(),fe=j.icon,Ne=D.icon,W=_(),ge=oe();return e.jsx(we,{title:"批处理任务状态",children:e.jsxs("div",{className:"space-y-3 w-full min-h-[calc(100vh-8rem)]",children:[e.jsxs("div",{className:"flex items-center justify-between",children:[e.jsx("div",{children:e.jsxs("div",{className:"flex items-center gap-2 mb-1",children:[e.jsx(I,{variant:"ghost",size:"sm",onClick:()=>i("/verification"),className:"p-1",children:e.jsx(Ee,{className:"h-4 w-4"})}),e.jsxs("p",{className:"text-muted-foreground text-sm",children:["任务ID: ",l]})]})}),e.jsxs("div",{className:"flex items-center gap-2",children:[e.jsxs(I,{onClick:A,variant:"outline",size:"sm",children:[e.jsx(Ae,{className:"h-4 w-4 mr-2"}),"刷新"]}),r&&(r.status===v.COMPLETED||r.status===v.COMPLETED_WITH_ERRORS)&&e.jsxs(I,{onClick:()=>i(`/verification/results/${l}`),size:"sm",children:[e.jsx($e,{className:"h-4 w-4 mr-2"}),"查看结果"]})]})]}),$?e.jsx(S,{className:"w-full h-96 flex items-center justify-center",children:e.jsx(E,{className:"flex items-center justify-center py-5",children:e.jsxs("div",{className:"text-center",children:[e.jsx(K,{className:"h-5 w-5 animate-spin mx-auto mb-2"}),e.jsx("p",{className:"text-muted-foreground text-sm",children:"正在加载批处理状态..."})]})})}):N||!r?e.jsxs(S,{className:"w-full h-96 flex items-center justify-center",children:[e.jsx(M,{className:"pb-2",children:e.jsxs(T,{className:"flex items-center text-red-600 text-base",children:[e.jsx(k,{className:"h-4 w-4 mr-2"}),"加载失败"]})}),e.jsxs(E,{children:[e.jsx("p",{className:"text-muted-foreground mb-3 text-sm",children:N instanceof Error?N.message:"无法获取批处理状态"}),e.jsx(I,{onClick:()=>w(),variant:"outline",size:"sm",children:"重试"})]})]}):e.jsxs("div",{className:"grid grid-cols-1 xl:grid-cols-4 gap-4 w-full flex-1",children:[e.jsxs("div",{className:"xl:col-span-3 space-y-4 w-full",children:[e.jsx(S,{className:"w-full",children:e.jsxs(E,{className:"py-4",children:[e.jsxs("div",{className:"flex items-center justify-between mb-3",children:[e.jsxs("div",{className:"flex items-center space-x-2",children:[e.jsx(fe,{className:`h-5 w-5 ${j.color==="blue"?"animate-spin":""} ${j.color==="green"?"text-green-600":j.color==="red"?"text-red-600":j.color==="orange"?"text-orange-600":j.color==="blue"?"text-blue-600":"text-gray-600"}`}),e.jsx(V,{variant:j.color==="green"?"default":j.color==="red"?"destructive":j.color==="orange"?"secondary":"outline",className:"text-sm px-3 py-1",children:j.text})]}),e.jsx("span",{className:"text-sm text-gray-500",children:new Date(r.updatedAt).toLocaleString("zh-CN")})]}),e.jsxs("div",{className:"space-y-1",children:[e.jsxs("div",{className:"flex justify-between text-sm",children:[e.jsx("span",{children:"处理进度"}),e.jsxs("span",{children:[W,"%"]})]}),e.jsx(ce,{value:W,className:"h-2"}),e.jsxs("div",{className:"text-xs text-gray-600",children:["已处理 ",r.tokensGeneratedCount," / ",r.totalEmployeesToProcess," 个员工"]})]})]})}),e.jsx(S,{children:e.jsx(E,{className:"py-3",children:e.jsxs("div",{className:"grid grid-cols-5 gap-2",children:[e.jsxs("div",{className:"text-center p-2 bg-blue-50 rounded-lg",children:[e.jsx(R,{className:"h-4 w-4 mx-auto mb-1 text-blue-600"}),e.jsx("p",{className:"text-base font-bold text-blue-600",children:r.totalEmployeesToProcess}),e.jsx("p",{className:"text-xs text-gray-600",children:"目标员工"})]}),e.jsxs("div",{className:"text-center p-2 bg-green-50 rounded-lg",children:[e.jsx(Y,{className:"h-4 w-4 mx-auto mb-1 text-green-600"}),e.jsx("p",{className:"text-base font-bold text-green-600",children:r.tokensGeneratedCount}),e.jsx("p",{className:"text-xs text-gray-600",children:"令牌生成"})]}),e.jsxs("div",{className:"text-center p-2 bg-purple-50 rounded-lg",children:[e.jsx(q,{className:"h-4 w-4 mx-auto mb-1 text-purple-600"}),e.jsx("p",{className:"text-base font-bold text-purple-600",children:r.emailsAttemptedCount}),e.jsx("p",{className:"text-xs text-gray-600",children:"邮件尝试"})]}),e.jsxs("div",{className:"text-center p-2 bg-orange-50 rounded-lg",children:[e.jsx(k,{className:"h-4 w-4 mx-auto mb-1 text-orange-600"}),e.jsx("p",{className:"text-base font-bold text-orange-600",children:r.emailsFailedCount}),e.jsx("p",{className:"text-xs text-gray-600",children:"邮件失败"})]}),e.jsxs("div",{className:"text-center p-2 bg-gray-50 rounded-lg",children:[e.jsx(F,{className:"h-4 w-4 mx-auto mb-1 text-gray-600"}),e.jsx("p",{className:"text-base font-bold text-gray-600",children:r.skippedEmployeesCount||0}),e.jsx("p",{className:"text-xs text-gray-600",children:"跳过员工"})]})]})})}),r.errorSummary&&e.jsxs(S,{className:"w-full flex-1",children:[e.jsx(M,{className:"pb-3"}),e.jsx(E,{className:"pt-0 flex-1",children:(()=>{const s=de(r.errorSummary),n=u?s:s.slice(0,5);return e.jsxs("div",{className:"space-y-4 h-full flex flex-col",children:[e.jsxs("div",{className:"flex items-center justify-between p-3 bg-red-50 border border-red-200 rounded-lg",children:[e.jsxs("div",{className:"flex items-center space-x-2",children:[e.jsx(k,{className:"h-5 w-5 text-red-600"}),e.jsxs("span",{className:"text-base font-medium text-red-800",children:["邮件发送失败-",s.length,"位员工邮件发送失败"]})]}),e.jsxs(V,{variant:"destructive",className:"text-sm px-2 py-1",children:[s.length,"人"]})]}),e.jsxs("div",{className:"space-y-3 flex-1",children:[e.jsxs("div",{className:"flex items-center justify-between",children:[e.jsxs("div",{className:"flex items-center space-x-2",children:[e.jsx(Q,{checked:m.length===s.length&&s.length>0,onCheckedChange:()=>pe(s)}),e.jsx("span",{className:"text-base font-medium",children:"失败员工列表"})]}),s.length>5&&e.jsx(I,{variant:"ghost",size:"sm",onClick:()=>C(!u),className:"h-8 px-3",children:u?"收起":`查看全部 ${s.length} 人`})]}),e.jsx("div",{className:"max-h-60 overflow-y-auto space-y-2 flex-1",children:n.map((t,a)=>e.jsxs("div",{className:"flex items-center space-x-3 p-3 border rounded-lg hover:bg-gray-50",children:[e.jsx(Q,{checked:m.includes(t.employeeId),onCheckedChange:c=>{o(c?x=>[...x,t.employeeId]:x=>x.filter(y=>y!==t.employeeId))}}),e.jsxs("div",{className:"flex-1 min-w-0",children:[e.jsxs("div",{className:"flex items-center space-x-2",children:[e.jsx("span",{className:"font-medium text-base",children:t.employeeName}),e.jsxs("span",{className:"text-sm text-gray-500",children:["(",t.employeeId,")"]})]}),e.jsxs("div",{className:"text-sm text-gray-600 truncate",children:[t.emailAddress," • ",t.reason]})]})]},a))})]}),e.jsxs("div",{className:"flex gap-3 pt-3 border-t",children:[e.jsxs(I,{variant:"default",size:"default",onClick:ue,disabled:m.length===0,className:"h-10",children:[e.jsx(q,{className:"h-4 w-4 mr-2"}),"补发邮件 (",m.length,")"]}),e.jsxs(I,{variant:"outline",size:"default",onClick:he,className:"h-10",children:[e.jsx(q,{className:"h-4 w-4 mr-2"}),"补发全部"]}),e.jsxs(I,{variant:"outline",size:"default",onClick:()=>i("/employees"),className:"h-10",children:[e.jsx(F,{className:"h-4 w-4 mr-2"}),"员工管理"]})]})]})})()})]}),r.skippedEmployeesSummary&&r.skippedEmployeesCount>0&&e.jsxs(S,{className:"w-full",children:[e.jsx(M,{className:"pb-3"}),e.jsx(E,{className:"pt-0",children:(()=>{const s=me(r.skippedEmployeesSummary);return e.jsxs("div",{className:"space-y-4",children:[e.jsxs("div",{className:"flex items-center justify-between p-3 bg-gray-50 border border-gray-200 rounded-lg",children:[e.jsxs("div",{className:"flex items-center space-x-2",children:[e.jsx(F,{className:"h-5 w-5 text-gray-600"}),e.jsxs("span",{className:"text-base font-medium text-gray-800",children:["跳过员工 - ",s.length,"位员工被跳过"]})]}),e.jsxs(V,{variant:"secondary",className:"text-sm px-2 py-1",children:[s.length,"人"]})]}),e.jsxs("div",{className:"space-y-3",children:[e.jsx("span",{className:"text-base font-medium",children:"跳过原因详情"}),e.jsx("div",{className:"max-h-60 overflow-y-auto space-y-2",children:s.map((n,t)=>e.jsx("div",{className:"flex items-center space-x-3 p-3 border rounded-lg bg-gray-50/50",children:e.jsxs("div",{className:"flex-1 min-w-0",children:[e.jsx("div",{className:"flex items-center space-x-2",children:e.jsx("span",{className:"font-medium text-base",children:n.employeeName})}),e.jsxs("div",{className:"text-sm text-gray-600",children:[n.departmentName&&n.departmentName!=="未知部门"&&e.jsxs(e.Fragment,{children:[e.jsx("span",{className:"text-gray-500",children:n.departmentName}),e.jsx("span",{className:"mx-1",children:"•"})]}),e.jsx("span",{children:n.emailAddress}),e.jsx("span",{className:"mx-1",children:"•"}),e.jsx("span",{className:"text-orange-600 font-medium",children:n.reason})]})]})},t))})]})]})})()})]})]}),e.jsxs("div",{className:"xl:col-span-1 space-y-4 w-full",children:[e.jsxs(S,{className:"w-full",children:[e.jsx(M,{className:"pb-3",children:e.jsx(T,{className:"text-lg",children:"任务信息"})}),e.jsxs(E,{className:"space-y-3 pt-0",children:[e.jsxs("div",{children:[e.jsxs("div",{className:"flex items-center mb-2",children:[e.jsx(Ne,{className:"h-5 w-5 mr-2 text-gray-600"}),e.jsx("span",{className:"text-base font-medium text-gray-500",children:"盘点范围"})]}),e.jsx("p",{className:"text-base",children:D.text})]}),D.detail&&e.jsxs("div",{children:[e.jsx("span",{className:"text-base font-medium text-gray-500",children:"范围详情"}),e.jsx("p",{className:"text-sm text-gray-700 break-all mt-1",children:D.detail})]}),e.jsxs("div",{children:[e.jsx("span",{className:"text-base font-medium text-gray-500",children:"有效期"}),e.jsxs("p",{className:"text-base",children:[r.requestedDurationDays," 天"]})]}),e.jsxs("div",{children:[e.jsx("span",{className:"text-base font-medium text-gray-500",children:"创建时间"}),e.jsx("p",{className:"text-base",children:new Date(r.createdAt).toLocaleString("zh-CN")})]})]})]}),e.jsxs(S,{className:"w-full",children:[e.jsx(M,{className:"pb-3",children:e.jsx(T,{className:"text-lg",children:"邮件发送统计"})}),e.jsxs(E,{className:"space-y-4 pt-0",children:[e.jsxs("div",{className:"text-center",children:[e.jsxs("p",{className:"text-3xl font-bold text-green-600",children:[ge,"%"]}),e.jsx("p",{className:"text-sm text-gray-600",children:"发送成功率"})]}),e.jsxs("div",{className:"space-y-2",children:[e.jsxs("div",{className:"flex justify-between text-base",children:[e.jsx("span",{children:"成功发送"}),e.jsx("span",{className:"text-green-600 font-semibold",children:r.emailsSucceededCount})]}),e.jsxs("div",{className:"flex justify-between text-base",children:[e.jsx("span",{children:"发送失败"}),e.jsx("span",{className:"text-red-600 font-semibold",children:r.emailsFailedCount})]}),e.jsxs("div",{className:"flex justify-between text-base",children:[e.jsx("span",{children:"总计尝试"}),e.jsx("span",{className:"font-semibold",children:r.emailsAttemptedCount})]})]})]})]})]})]})]})})};export{Ue as default};
